好的～我把两章都收敛成**功能流程级**描述（不含实现/代码/接口细节），并纳入“简化 Chat：无播放控件、分段顺播、点段从头播”的决策。

# 1) 信息架构与交互细节（IA + Flow）

## 1.1 导航结构

* **主入口**：相机主页（底层页面）。
* **叠加层**：**Chat Overlay**（讲解展示 + 播放 + 再生成指令）。
* **抽屉**：地图、设置。
* **历史**：以「对话线程」形式在 Chat Overlay 中查看与重播（不再有单独历史页）。

## 1.2 主要界面

* **相机主页**：全屏相机、快门、相册入口、定位模式切换（精准/模糊）、进入 Chat 的快捷入口。
* **Chat Overlay（核心）**：消息列表（按段落分段显示）、输入栏（自然语言指令）、轻量状态提示（加载/失败/重试）。
* **地图**：附近点位列表（卡片），可直达对应线程的 Chat Overlay。
* **设置**：语言/音色、到点自动播放开关（需耳机）、离线缓存、隐私。

## 1.3 核心用户流程

* **拍照触发**

  1. 拍照提交（含GPS/EXIF）。
  2. 服务器检索命中或生成讲解，返回**分段文本 + 对应音频**。
  3. Chat Overlay 自动出现并**从第1段开始顺序播放**；文本按段逐条显示并高亮当前段。
  4. 用户可在输入栏下达再生成/风格变更指令，新结果以新消息块追加，并**从该块第1段顺播**。
* **到点触发**

  1. 进入围栏。
  2. 默认推送“讲解已准备”通知；若用户开启自动播放且耳机连接，则直接打开/激活 Chat 并**从第1段顺播**。
  3. 文本与播放在 Chat 中同步推进，当前段自动高亮与滚动。
* **点击段落重播**

  * 点击任一段落气泡 → **从该段开头播放**，随后继续顺播后续段。
* **历史与重播**

  * 每次拍照/到点形成一个线程；在 Chat 中直接浏览历史线程，点任一段即可从头播放并顺播。

## 1.4 状态与边界

* **失败与回退**：任一步失败在 Chat 中以错误气泡呈现，提供重试；TTS 未就绪时优先展示文本，后补音频并从第1段顺播或按用户点击段播放。
* **并发仲裁**：短时间内同时出现“拍照触发”和“到点触发”，以**拍照**线程优先。
* **中断恢复**：来电/切后台返回后，**从当前段开头**继续顺播。
* **权限/网络空态**：相机或定位被拒、无网状态在相机页予以引导；Chat 可浏览与重播离线命中内容。

## 1.5 体验基线（功能口径）

* 分段展示、自动顺播、段落点击从头播放、自动高亮与滚动。
* 到点自动播放需用户显式开启且耳机连接，默认仅通知。
* 历史即对话线程，无独立播放页与历史页。
